create database TECHNICALTEST;
-- Table 1: AEROLINEA
CREATE TABLE AEROLINEA (
    ID_AEROLINEA INT PRIMARY KEY,
    NOMBRE_AEROLINEA VARCHAR(50)
);

-- Inserting values into AEROLINEA table
INSERT INTO AEROLINEA (ID_AEROLINEA, NOMBRE_AEROLINEA) VALUES
(1, 'Volaris'),
(2, 'Aeromar'),
(3, 'Interjet'),
(4, 'Aeromexico');

-- Table 2: AEROPUERTO
CREATE TABLE AEROPUERTO (
    ID_AEROPUERTO INT PRIMARY KEY,
    NOMBRE_AEROPUERTO VARCHAR(50)
);

-- Inserting values into AEROPUERTO table
INSERT INTO AEROPUERTO (ID_AEROPUERTO, NOMBRE_AEROPUERTO) VALUES
(1, 'Benito Juarez'),
(2, 'Guanajuato'),
(3, 'La Paz'),
(4, 'Oaxaca');

-- Table 3: MOVIMIENTO
CREATE TABLE MOVIMIENTO (
    ID_MOVIMIENTO INT PRIMARY KEY,
    DESCRIPCION VARCHAR(50)
);

-- Inserting values into MOVIMIENTO table
INSERT INTO MOVIMIENTO (ID_MOVIMIENTO, DESCRIPCION) VALUES
(1, 'Salida'),
(2, 'Llegada');

-- Table 4: VUELO
CREATE TABLE VUELO (
    ID_AEROLINEA INT,
    ID_AEROPUERTO INT,
    ID_MOVIMIENTO INT,
    DIA DATE,
    FOREIGN KEY (ID_AEROLINEA) REFERENCES AEROLINEA(ID_AEROLINEA),
    FOREIGN KEY (ID_AEROPUERTO) REFERENCES AEROPUERTO(ID_AEROPUERTO),
    FOREIGN KEY (ID_MOVIMIENTO) REFERENCES MOVIMIENTO(ID_MOVIMIENTO)
);

-- Inserting values into VUELO table
INSERT INTO VUELO (ID_AEROLINEA, ID_AEROPUERTO, ID_MOVIMIENTO, DIA) VALUES
(1, 1, 1, '2021-05-02'),
(2, 1, 1, '2021-05-02'),
(3, 2, 2, '2021-05-02'),
(4, 3, 2, '2021-05-02'),
(1, 3, 2, '2021-05-02'),
(2, 1, 1, '2021-05-02'),
(2, 3, 1, '2021-05-04'),
(3, 4, 1, '2021-05-04'),
(3, 4, 1, '2021-05-04');

SELECT A.NOMBRE_AEROPUERTO, COUNT(*) AS MOVEMENT_COUNT
FROM VUELO V
JOIN AEROPUERTO A ON V.ID_AEROPUERTO = A.ID_AEROPUERTO
GROUP BY V.ID_AEROPUERTO
ORDER BY MOVEMENT_COUNT DESC
LIMIT 1;

SELECT A.NOMBRE_AEROLINEA, COUNT(*) AS FLIGHT_COUNT
FROM VUELO V
JOIN AEROLINEA A ON V.ID_AEROLINEA = A.ID_AEROLINEA
GROUP BY V.ID_AEROLINEA
ORDER BY FLIGHT_COUNT DESC
LIMIT 1;

SELECT DIA, COUNT(*) AS FLIGHT_COUNT
FROM VUELO
GROUP BY DIA
ORDER BY FLIGHT_COUNT DESC
LIMIT 1;

SELECT A.NOMBRE_AEROLINEA, V.DIA, COUNT(*) AS MOVEMENT_COUNT
FROM VUELO V
JOIN AEROLINEA A ON V.ID_AEROLINEA = A.ID_AEROLINEA
GROUP BY A.NOMBRE_AEROLINEA, V.DIA
HAVING COUNT(*) >= 2;


